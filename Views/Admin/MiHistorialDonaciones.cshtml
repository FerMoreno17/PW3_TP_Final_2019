
@{
    Layout = "../Shared/_LayoutAdmin.cshtml";
    ViewBag.Title = "MiHistorialDonaciones";
}

<h3><i class="fa fa-angle-right mt-0"></i> Donaciones recibidas</h3>
    <div class="row mt">
        <div class="container">
            <div class="content-panel">
                <h6><i class="fa fa-angle-right ml-3"></i> Detalle de donaciones recibidas.</h6>
                <hr>
                <table class="table table-striped table-advance table-hover">
                    <thead>
                        <tr class="text-center">

                            <th scope="col"><i class="fa fa-calendar"></i> Fecha</th>
                            <th scope="col"><i class="fa fa-newspaper-o"></i> Propuesta</th>
                            <th scope="col"><i class="fa fa-check-circle-o"></i> Tipo</th>
                            <th scope="col"><i class="fa fa-hourglass-start"></i> Estado</th>
                            <th scope="col"><i class="fa fa-heart-o"></i> Total Recaudado</th>
                            <th scope="col"><i class="fa fa-star-o"></i> Mi Donación</th>
                            <th scope="col"><i class="fa fa-eye"></i> Detalle</th>
                        </tr>
                    </thead>
                    <tbody id="mostrarContenido">
                    </tbody>
                </table>
            </div>
    </div>
</div>
                <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
                <script>
    $(document).ready(
        function () {
            var cadena;
            var url='https://localhost:44386/api/HistorialDonaciones/@ViewBag.Usuario'
            $.getJSON(url, function (data) {
                data.forEach(function (item) {
                var p = new Date(item.FechaDonacion);
                    cadena += `<tr  class="text-center">`
                    cadena += `<td>${p.getDate()}-${p.getMonth()}-${p.getFullYear()}</td>`
                    cadena += `<td>${item.Nombre}</td>`
                    
                    if (item.Tipo == 1) {

                        cadena += '<td>Monetaria</td>'
                    }
                    if (item.Tipo == 2) {

                        cadena += '<td>Insumos</td>'
                    }
                    if (item.Tipo == 3) {

                        cadena += '<td>Horas Trabajo</td>'
                    }

                    if (item.Estado==1) {

                        cadena += `<td>Abierto</td>`
                    }
                    if (item.Estado==0) {

                        cadena += `<td>Cerrado</td>`
                    }

                    cadena += `<td>${item.TotalRecaudado}</td>`
                    cadena += `<td>${item.MiDonacion}</td>`
                    cadena += `<td> <a href="/Detalle/Propuestas/${item.IdPropuesta}">Ir a Propuesta</a> </td>`
                    cadena+=`</tr>`

                });


                $("#mostrarContenido").html(cadena);
            });

        }
    );
                </script>

